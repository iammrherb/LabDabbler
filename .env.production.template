# LabDabbler Production Environment Configuration Template
# Copy this file to .env.production and set the actual values

# Application Configuration
NODE_ENV=production
ENVIRONMENT=production

# Backend Configuration
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
API_URL=https://api.labdabbler.com
FRONTEND_URL=https://labdabbler.com

# =============================================================================
# CRITICAL SECURITY VARIABLES - MUST BE SET BEFORE DEPLOYMENT
# =============================================================================

# Database Configuration (REQUIRED: Use strong 32+ character password)
DATABASE_PASSWORD=CHANGE_ME_TO_STRONG_PASSWORD_32_CHARS_MIN
DATABASE_URL=postgresql://labdabbler_user:${DATABASE_PASSWORD}@postgres:5432/labdabbler_production
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30

# Redis Configuration (REQUIRED: Use strong 24+ character password)
REDIS_PASSWORD=CHANGE_ME_TO_STRONG_PASSWORD_24_CHARS_MIN
REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0

# Application Security (REQUIRED: Use cryptographically secure 32+ byte keys)
SECRET_KEY=CHANGE_ME_TO_SECURE_32_BYTE_SECRET_KEY
JWT_SECRET=CHANGE_ME_TO_SECURE_32_BYTE_JWT_SECRET

# Monitoring Admin Password (REQUIRED: Use strong password for Grafana admin)
GRAFANA_PASSWORD=CHANGE_ME_TO_STRONG_ADMIN_PASSWORD

# Network Security (UPDATE: Replace with your actual domains)
ALLOWED_HOSTS=localhost,127.0.0.1,backend,labdabbler-backend,your-domain.com,api.your-domain.com
CORS_ORIGINS=https://your-domain.com,https://www.your-domain.com,https://api.your-domain.com

# SSL/HTTPS Configuration
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/labdabbler.crt
SSL_KEY_PATH=/etc/ssl/private/labdabbler.key

# Container and Lab Management
DOCKER_HOST=tcp://docker-daemon:2376
DOCKER_TLS_VERIFY=1
DOCKER_CERT_PATH=/certs/client
CONTAINERLAB_PATH=/usr/bin/clab
DATA_DIRECTORY=/app/data
LABS_DIRECTORY=/app/labs
CONFIGS_DIRECTORY=/app/configs

# File Upload Configuration
MAX_UPLOAD_SIZE=1073741824  # 1GB in bytes
UPLOAD_DIRECTORY=/app/uploads

# Logging Configuration
LOG_LEVEL=INFO
LOG_FILE=/var/log/labdabbler/app.log
ACCESS_LOG_FILE=/var/log/labdabbler/access.log
ERROR_LOG_FILE=/var/log/labdabbler/error.log

# Monitoring and Performance
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL=30

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=3600  # 1 hour in seconds

# Cache Configuration
CACHE_TTL=3600  # 1 hour
ENABLE_RESPONSE_COMPRESSION=true

# Worker Configuration
WORKER_PROCESSES=4
WORKER_CONNECTIONS=1000
WORKER_TIMEOUT=30

# Repository Sync Configuration
REPO_SYNC_INTERVAL=3600  # 1 hour
AUTO_SYNC_ENABLED=true

# =============================================================================
# SECURITY DEPLOYMENT CHECKLIST
# =============================================================================
#
# BEFORE DEPLOYING TO PRODUCTION, ENSURE YOU HAVE:
#
# 1. ✅ Changed ALL default passwords above (search for "CHANGE_ME")
# 2. ✅ Generated cryptographically secure SECRET_KEY and JWT_SECRET (32+ bytes each)
# 3. ✅ Updated ALLOWED_HOSTS with your actual domain names
# 4. ✅ Updated CORS_ORIGINS with your actual frontend URLs
# 5. ✅ Obtained and configured proper SSL certificates
# 6. ✅ Reviewed firewall rules and network security
# 7. ✅ Set up log monitoring and alerting
# 8. ✅ Created database and application backups
# 9. ✅ Tested disaster recovery procedures
# 10. ✅ Reviewed all security configurations
#
# SECURITY NOTES:
# - Use a password manager to generate strong, unique passwords
# - Minimum password lengths: DATABASE_PASSWORD (32+), REDIS_PASSWORD (24+)
# - Never commit real secrets to version control
# - Consider using external secrets management (AWS Secrets Manager, etc.)
# - Regularly rotate passwords and monitor for unauthorized access
# - Review logs for suspicious activity
# - Keep all containers and dependencies updated
#
# PRODUCTION DEPLOYMENT COMMAND:
# ./scripts/deploy.sh deploy
#
# =============================================================================